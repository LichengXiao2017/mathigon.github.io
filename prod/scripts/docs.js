/* (c) 2014, Mathigon */

function $(a){if("string"==typeof a){var b=document.getElementById(a);if(b)return new M.$(b)}else if(a instanceof Node||a===window)return new M.$(a)}function $C(a,b){b=b?b.$el:document;var c=b.getElementsByClassName(a);return M.each(c,function(a){return new M.$(a)})}function $T(a,b){b=b?b.$el||b:document;var c=b.getElementsByTagName(a);window.X=c;var d=M.each(c,function(a){return new M.$(a)});return window.Y=d,d}function $$(a,b){b=b?b.$el:document;var c=b.querySelectorAll(a);return M.each(c,function(a){return new M.$(a)})}function $N(a,b,c){var d=document.createElement(a);for(var e in b)"id"===e?d.id=b.id:"class"===e?d.className=b.class:"html"===e?d.innerHTML=b.html:d.setAttribute(e,b[e]);var f=new M.$(d);return c&&c.append(f),f}function $$N(a){var b=$N("div",{html:a});return b.children()}window.onload=function(){var $sidebarTopicWrap,$sidebar=$C("sidebar-wrap")[0],posn={};M.resize(function(){posn={}}),$("api").find("h2, h3").each(function($el){var $sidebarEl,$topicWrap;$el.is("h2")?($sidebarEl=$N("div",{"class":"sidebar-h2",html:$el.html()},$sidebar),$sidebarTopicWrap=$topicWrap=$N("div",{style:"display: none"},$sidebar)):($sidebarEl=$N("div",{"class":"sidebar-h3",html:$el.html()},$sidebarTopicWrap),$topicWrap=$sidebarTopicWrap);var top=$el.$el.offsetTop;posn[top]=[$sidebarEl,$topicWrap],M.resize(function(){top=$el.$el.offsetTop,posn[top]=[$sidebarEl,$topicWrap]}),$sidebarEl.click(function(){M.$body.scrollTo(top-75,1e3)})});var $sidebarActive,$sidebarActiveBox,$sidebar=$C("sidebar")[0],bodyTop=$("body").$el.offsetTop-40,getActive=function(s){for(var i in posn)if(i>s)return posn[i]};M.$body.scroll({move:function(){var scroll=M.$body.$el.scrollTop;$sidebar.setClass("fixed",scroll>bodyTop);var active=getActive(scroll);active[0]!==$sidebarActive&&($sidebarActive&&$sidebarActive.removeClass("active"),$sidebarActive=active[0],$sidebarActive.addClass("active")),active[1]!==$sidebarActiveBox&&($sidebarActiveBox&&$sidebarActiveBox.hide(),$sidebarActiveBox=active[1],$sidebarActiveBox&&$sidebarActiveBox.show())}})};var M=M||{};M.noop=function(){},M.proto=function(a,b,c,d){Object.defineProperty(a.prototype,b,{enumerable:d||!1,writable:!0,value:c})},M.each=function(a,b){var c,d=a.length;if(0===d||d&&a.hasOwnProperty(d-1)){c=[];for(var e=0;d>e;++e)a.hasOwnProperty(e)&&c.push(b(a[e],e))}else{c={};for(var e in a)a.hasOwnProperty(e)&&(c[e]=b(a[e],e))}return c},M.include=function(a,b,c){b instanceof Object&&M.each(b,function(b,d){M.proto(a,d,b,c)})},M.extend=function(a){for(var b=1,c=arguments.length;c>b;b++)for(var d in arguments[b])a[d]=arguments[b][d];return a},M.inherit=function(a,b){a.prototype=new b,a.prototype.constructor=this},M.run=function(a,b,c){return a instanceof Function?a.apply(c||null,b):a},M.merge=function(){for(var a={},b=0;b<arguments.length;++b)M.each(arguments[b],function(b,c){a[c]=b});return a},M.Class=function(){this._events={}},M.include(M.Class,{on:function(a,b){this._events[a]?this._events[a].indexOf(b)<0&&this._events[a].push(b):this._events[a]=[b]},off:function(a,b){if(this._events[a]){var c=this._events[a].indexOf(b);c>=0&&this._events.splice(c,1)}},trigger:function(a,b){if(this._events[a]){var c=this;M.each(this._events[a],function(a){a.call(c,b)})}},include:function(a){M.include(this,a)}},!0),M.Class.extend=function(a){var b=this,c=function(){this._events={},a.init&&a.init.apply(this,arguments)};c.prototype={};for(var d in b.prototype)c.prototype[d]=b.prototype[d];for(d in a)"init"!==d&&(c.prototype[d]=a[d]);return c.extend=M.Class.extend,c.prototype.constructor=c,c.parent=b,c},M.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},M.include(Array,{clone:function(){return this.slice(0)},first:function(){return this[0]},last:function(){return this.length?this[this.length-1]:void 0},each:function(a){for(var b=[],c=0,d=this.length;d>c;++c)this.hasOwnProperty(c)&&(b[c]=a(this[c],c));return b},eachReverse:function(a){for(var b=[],c=this.length-1;c>=0;--c)this.hasOwnProperty(c)&&(b[c]=a(this[c],c));return b},min:function(){return Math.min.apply(Math,this)},max:function(){return Math.max.apply(Math,this)},total:function(){for(var a=0,b=0,c=this.length;c>b;++b)a+=Number(this[b])||0;return a},clean:function(){for(var a=[],b=0,c=this.length;c>b;++b)null!==this[b]&&void 0!==this[b]&&a.push(this[b]);return a},unique:function(){for(var a=[],b=0,c=this.length;c>b;++b)-1===a.indexOf(this[b])&&a.push(this[b]);return a},without:function(a){for(var b=[],c=0,d=this.length;d>c;++c)this[c]!==a&&b.push(this[c]);return b},chunk:function(a){for(var b=[],c=[],d=0,e=0,f=this.length;f>e;++e)c.push(this[e]),++d,d>=a&&(b.push(c),c=[],d=0);return c.length&&b.push(c),b},rotate:function(a){var b=this.length;a=(a%b+b)%b;var c=this.slice(0,a),d=this.slice(a);return Array.prototype.push.apply(d,c),d},average:function(){return this.length?this.total()/this.length:0},normalise:function(){for(var a=[],b=this.total(),c=0;c<this.length;++c)a.push(this[c]/b);return a},variance:function(){for(var a=this.length,b=this.average(),c=[],d=0,e=this.length;e>d;++d)c[d]=FM.square(this[d]-b);return c.total()/a},standardDev:function(){return Math.sqrt(this.variance())},median:function(){var a=this.clone();a.sort(function(a,b){return a-b});var b=a.length,c=b/2;return c%1===0?.5*a[c-1]+.5*a[c]:a[Math.floor(c)]},shuffle:function(){for(var a,b,c=this.clone(),d=c.length-1;d;--d)a=Math.floor(Math.random()*(d+1)),b=c[a],c[a]=c[d],c[d]=b;return c},toNumbers:function(){return this.each(function(a){return+a})}}),M.list=function(a,b,c){null==b&&(b=a,a=0),c=c||1;for(var d=[],e=a;b>=e;e+=c)d.push(e);return d},M.include(String,{strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")},collapse:function(){return this.trim().replace(/\s+/g," ")},toTitleCase:function(){return this.replace(/\S+/g,function(a){return a.charAt(0).toUpperCase()+a.slice(1)})},words:function(){return this.strip().split(/\s+/)}}),M.isObject=function(a){return a===Object(a)},M.has=function(a,b){return hasOwnProperty.call(a,b)},M.keys=function(a){if(!M.isObject(a))return[];var b=[];for(var c in a)M.has(a,c)&&b.push(c);return b},M.invert=function(a){for(var b={},c=M.keys(a),d=0,e=c.length;e>d;++d)b[a[c[d]]]=c[d];return b},M.create=Object.create||function(){function a(){}return function(b){return a.prototype=b,new a}}(),M.isOneOf=function(a){for(var b=1;b<arguments.length;++b)if(a===arguments[b])return!0;return!1},M.watch=function(a,b,c){var d=a[b],e=function(){return d},f=function(a){return oldVal=d,d=a,a=c.call(this,a,oldVal)};delete a[b]&&Object.defineProperty(a,b,{get:e,set:f,enumerable:!0,configurable:!0})},M.unwatch=function(a,b){var c=a[b];delete a[b],a[b]=c},M.include(Number,{seperators:function(){for(var a=(this+"").split("."),b=a[0],c=/(\d+)(\d{3})/;c.test(b);)b=b.replace(c,"$1,$2");return b+(a.length>1?"."+a[1]:"")},round:function(a){var b=Math.pow(10,a);return Math.round(a*b)/b},bound:function(a,b){return Math.min(b,Math.max(a,this))},between:function(a,b){return this>=a&&b>=this}}),M.toOrdinal=function(a){if(this%100>=11&&13>=a%100)return a+"th";switch(a%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd";default:return a+"th"}},M.isInteger=function(a){return a%1===0},M.isDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)},M.isNaN=function(a){return a!==a},function(){function a(a){for(var b=[],c=0,d=a.length;d>c;++c)b.push(+a[c]);return b}function b(a,b){for(var c=0,d=a.length;d>c;++c)if(a[c]===b)return c;return-1}function c(a,b){return Array.prototype.concat.apply(a,b)}var FM={};window.FM=window.Fermat=FM,function(){function a(b,c,d){var e=[];if(1===d.length)for(var f=0;f<d[0];++f)e.push(b.apply(null,c.concat([f])));else for(var g=d.clone(),h=g.pop(),f=0;h>f;++f)e.push(a(b,c.concat([f]),g));return e}FM.tabulate=function(b){var c=[];return Array.prototype.push.apply(c,arguments),c.shift(),a(b,[],c)}}(),FM.range=function(a,b){var c=[];if(null==b&&a>=0)for(var d=0;a>d;++d)c.push(d);else if(null==b)for(var d=0;d>a;--d)c.push(d);else if(b>=a)for(var d=a;b>=d;++d)c.push(d);else for(var d=a;d>=b;--d)c.push(d);return c},FM.shuffle=function(a){a=[].slice.call(a,0);for(var b=a.length;b>0;b--){var c=Math.floor(Math.random()*b),d=a[c];a[c]=a[b-1],a[b-1]=d}return a},FM.sort=function(a){return a.slice(0).sort(function(a,b){return a-b})};var d=1e-9;FM.isInt=function(a){return parseFloat(a)===parseInt(a,10)&&!isNaN(a)},FM.equals=function(a,b,c){return Math.abs(a-b)<(c||d)},FM.sign=function(a){return FM.equal(a,0)?0:Math.abs(a)/a},FM.square=function(a){return a*a},FM.cube=function(a){return a*a*a},FM.digits=function(a){if(0===a)return[0];for(var b=[];a>0;)b.push(a%10),a=Math.floor(a/10);return b},FM.decimalDigits=function(b){var c=""+Math.abs(b-Math.floor(b));return a(c.split(""))},FM.decimalPlaces=function(a){var b=""+Math.abs(a);return b=b.split("."),1===b.length?0:b[1].length},FM.roundTowardsZero=function(a){return 0>a?Math.ceil(a-1e-4):Math.floor(a+1e-4)},FM.round=function(a,b){var c=Math.pow(10,b||0);return Math.round(a*c)/c},FM.roundTo=function(a,b){return b||(b=1),Math.round(a/b)*b},FM.toFixed=function(a,b){var c=a.toFixed(b);return FM.equals(a,+c)?c:"~ "+c},FM.toFraction=function(a,b){b=b||1e3;for(var c=[1,0],d=[0,1],e=Math.floor(a),f=a-e;d[0]<=b;){if(FM.equal(c[0]/d[0],a))return[c[0],d[0]];c=[e*c[0]+c[1],c[0]],d=[e*d[0]+d[1],d[0]],e=Math.floor(1/f),f=1/f-e}return[a,1]};var e=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97];FM.gcd=function j(a,b){if(arguments.length>2){var c=[].slice.call(arguments,1);return j(a,j.apply(null,c))}var d;for(a=Math.abs(a),b=Math.abs(b);b;)d=a%b,a=b,b=d;return a},FM.lcm=function k(a,b){if(arguments.length>2){var c=[].slice.call(arguments,1);return k(a,k.apply(null,c))}return Math.abs(a*b)/FM.gcd(a,b)},FM.isPrime=function(a){if(1>=a||!FM.isInt(a))return!1;if(101>a)return b(e,a)>=0;if(a%2===0)return!1;for(var c=Math.sqrt(a),d=3;c>=d;d+=2)if(a%d===0)return!1;return!0},FM.isOdd=function(a){return a%2===1},FM.isEven=function(a){return a%2===0},FM.primeFactorization=function l(a){if(1===a)return[];if(FM.isPrime(a))return[a];for(var b=Math.sqrt(a),d=2;b>=d;++d)if(a%d===0)return c(l(d),l(a/d))},FM.getFactors=function(a){return FM.primeFactorization(a).unique()},FM.listPrimes=function(a){if(2>a)return[];for(var b=[2],c=3;a>=c;c++){var d=!1;for(var e in b)M.has(b,e)&&(d=d||0===c%b[e]);d||b.push(c)}return b};var f=Math.sqrt(5);FM.fibonacci=function(a){return Math.round(Math.pow(1+f,a)-Math.pow(1-f,a))/(Math.pow(2,a)*f)},FM.random={},FM.random.integer=function(a){return Math.floor(a*Math.random())},FM.random.integerArray=function(a){for(var b=[],c=0;a>c;++c)b.push(c);return b.shuffle()},FM.random.uniformInt=function(a,b){return Math.floor(a+(b-a+1)*Math.random())},FM.random.bernoulli=function(a){return a=Math.max(0,Math.min(1,a)),Math.random()<a?1:0},FM.random.binomial=function(a,b){for(var c=0,d=0;a>d;++d)c+=FM.random.bernoulli(b);return c},FM.random.poisson=function(a){if(0>=a)return 0;for(var b=Math.exp(-a),c=1,d=0;c>b;++d)c*=Math.random();return d-1},FM.random.uniform=function(a,b){return a+(b-a)*Math.random()},FM.random.normal=function(){var a=Math.random(),b=Math.random();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*b)},FM.random.exponential=function(a){return 0>=a?0:-Math.log(Math.random())/a},FM.random.geometric=function(a){return 0>=a||a>0?null:Math.floor(Math.log(Math.random())/Math.log(1-a))},FM.random.cauchy=function(){var a,b,c;do b=2*Math.random()-1,c=2*Math.random()-1,a=b*b+c*c;while(a>=1);return b/c},FM.factorial=function m(a){return 1>=a?a||1:a*m(a-1)},FM.binomial=function n(a,b){if(0===b)return 1;if(2*b>a)return n(a,a-b);for(var c=1,d=b;d>0;--d)c*=a-d+1,c/=d;return c},FM.permutations=function(a){function b(a){for(var e=0;e<a.length;e++){var f=a.splice(e,1)[0];d.push(f),0===a.length&&c.push(d.slice()),b(a),a.splice(e,0,f),d.pop()}return c}var c=[],d=[];return b(a)},function(){function a(b){if(1===b.length)return[[],b];for(var c=b.pop(),d=a(b),e=[],f=0;f<d.length;++f){var g=d[f].clone();g.push(c),e.push(d[f],g)}return e}FM.subsets=function(b,c){var d=b.clone(),e=a(d);return c&&(e=e.filter(function(a){return a.length===c})),e.sort(function(a,b){return a.length-b.length})}}(),FM.coinFlips=function(a){for(var b="",c=0;a>c;++c)b+=Math.random()>=.5?"H":"T";return b},FM.travellingSalesman=function(a){var b=a.length,c=FM.range(b),d=1/0,e=null;return FM.permutations(c).each(function(c){for(var f=0,g=0;b-1>g;++g)if(f+=a[c[g]][c[g+1]],f>d)return;d>f&&(d=f),e=c}),{path:e,length:d}},FM.travellingSalesmanGreedy=function(){},FM.travellingSalesman2Opt=function(){},FM.sum=function(a){for(var b=0,c=0,d=a.length;d>c;++c)b+=a[c]||0;return b},FM.mean=function(a){return FM.sum(a)/a.length},FM.median=function(a){var b=FM.sort(a);return a.length%2===0?(b[a.length/2-1]+b[a.length/2])/2:b[Math.floor(a.length/2)]},FM.mode=function(a){for(var b,c=[],d=-1,e=0;e<a.length;e++)c[a[e]]?(c[a[e]]+=1,c[a[e]]>d&&(d=c[a[e]],b=a[e])):c[a[e]]=1;for(var e=0;e<c.length;e++)if(c[e]&&e!==b&&c[e]>=d)return null;return b},FM.variance=function(a){for(var b=FM.mean(a),c=a.length,d=0,e=0;c>e;++e)d+=FM.square(a[e]-b);return d/(c-1)},FM.stdDev=function(a){return Math.sqrt(FM.variance(a))},FM.covariance=function(a,b){if(a.length!==b.length)throw new Error("Array length mismatch");for(var c=a.length,d=0,e=0;c>e;e++)d+=a[e]*b[e];return(d-a.total()*b.total()/c)/c},FM.correlation=function(a,b){if(a.length!==b.length)throw new Error("Array length mismatch");var c=FM.covariance(a,b),d=a.standardDev(),e=b.standardDev();return c/(d*e)},FM.rSquared=function(a,b){var c=a.each(function(a,c){return FM.square(a-b[c])}).sum(),d=a.each(function(b){return FM.square(b-a.average())}).sum();return 1-c/d},FM.linearRegression=function(a,b){var c=a.length,d=a.sum(),e=b.sum(),f=a.each(function(a,c){return a*b[c]}).sum(),g=a.each(function(a){return a*a}).sum(),h=a.average(),i=b.average(),j=(f-1/c*d*e)/(g-1/c*d*d),k=i-j*h;return function(a){return k+j*a}},FM.normalPDF=function(a,b,c){return 1/Math.sqrt(2*Math.PI*b*b)*Math.exp(-((c-a)*(c-a))/(2*b*b))},FM.Complex=function(a,b){this.re=a,this.im=b},M.extend(FM.Complex,{add:function(a){return new FM.complex(this.re+a.re,this.im+a.im)},subtract:function(a){return new FM.complex(this.re-a.im,this.im-a.im)},multiply:function(a){var b=this.re*a.re-this.im*a.im,c=this.im*a.re+this.re*a.im;return new FM.complex(b,c)},divide:function(a){var b=a.re*a.re+a.im*a.im,c=(this.re*a.re+this.im*a.im)/b,d=(this.im*a.re-this.re*a.im)/b;return new FM.complex(c,d)},magnitude:function(){return Math.sqrt(this.re*this.re+this.im*this.im)},phase:function(){return Math.atan2(this.im,this.re)}}),FM.vector={},FM.vector.add=function(a,b){return[a[0]+b[0],a[1]+b[1]]},FM.vector.diff=function(a,b){return[a[0]-b[0],a[1]-b[1]]},FM.vector.mult=function(a,b){return[a[0]*b,a[1]*b]},FM.vector.dot=function(a,b){if(a.length!==b.length)throw new Error("Vector length mismatch");for(var c=0,d=0;d<a.length;d++)c+=a[d]*b[d];return c},FM.vector.cross=function(a,b){return a[0]*b[1]-a[1]*b[0]},FM.vector.length=function(a){return Math.sqrt(FM.square(a[0])+FM.square(a[1]))},FM.vector.normalise=function(a){return FM.vector.mult(a,1/FM.vector.length(a))},FM.Matrix=function(a){for(var b=0;b<a.length;++b)this[b]=a[b];this.rows=a.length,this.cols=a[0].length},FM.Matrix.prototype.isSquare=function(){return this.rows===this.cols},FM.Matrix.prototype.transpose=function(){for(var a=[],b=0;b<this.rows;b++){a[b]=[];for(var c=0;c<this.cols;c++)a[b][c]=this.array[c][b]}return new FM.matrix(a)},FM.Matrix.prototype.determinant=function(){var a,b,c,d,e=0;if(!this.isSquare())throw new Error("Not a square matrix.");if(1===this.rows)return this[0][0];if(2===this.rows)return this[0][0]*this[1][1]-this[0][1]*this[1][0];for(b=0;b<this.cols;b++){for(c=this[0][b],d=this[0][b],a=1;a<this.rows;a++)d*=this[a][((b+a)%this.cols+this.cols)%this.cols],c*=this[a][((b-a)%this.cols+this.cols)%this.cols];e+=d-c}return e},FM.Matrix.prototype.scalarMultiply=function(a){for(var b=[],c=0;c<this.rows;c++){b[c]=[];for(var d=0;d<this.cols;d++)b[c][d]=a*this[c][d]}return new FM.matrix(b)},FM.identityMatrix=function(a){for(var b=[],c=0;a>c;c++){b[c]=[];for(var d=0;a>d;d++)b[c][d]=c===d?1:0}return new FM.matrix(b)},FM.matrixAddition=function(a,b){if(a.rows!==b.rows||a.cols!==b.cols)throw new Error("Matrix size mismatch");for(var c=[],d=0;d<a.length;++d){c[d]=[];for(var e=0;e<a[d].length;++e)c[d][e]=a[d][e]+b[d][e]}return new FM.matrix(c)},FM.matrixMultiplication=function(a,b){if(a.cols!==b.rows)throw new Error("Matrix size mismatch");for(var c=[],d=0;d<a.rows;d++)c[d]=[];for(var e=b.transpose(),f=0;f<a.rows;f++)for(var g=0;g<b.cols;g++)c[f][g]=FM.dotproduct(a[f],e[g]);return FM.matrix(c)},FM.geo={},FM.geo.distance=function(a,b){return Math.sqrt(FM.square(a[0]-b[0])+FM.square(a[1]-b[1]))},FM.geo.manhatten=function(a,b){return Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1])},FM.geo.intersect=function(a,b,c,d){var e=FM.vector.diff(b,a),f=FM.vector.diff(d,c),g=FM.vector.diff(a,c),h=FM.vector.cross(f,e);if(0!==h){var i=f[1]*g[0]-f[0]*g[1],j=e[1]*g[0]-e[0]*g[1],k=i/h,l=j/h;if(k.between(0,1)&&l.between(0,1)){var m=a[0]+k*(b[0]-a[0]),n=a[1]+l*(b[1]-a[1]);return[m,n]}}};var g="abcdefghijklmnopqrstuvwxyz",h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i={a:.08167,b:.01492,c:.02782,d:.04253,e:.12702,f:.02228,g:.02015,h:.06094,i:.06966,j:.00154,k:.00772,l:.04024,m:.02406,n:.06749,o:.07507,p:.01929,q:95e-5,r:.05987,s:.06327,t:.09056,u:.02758,v:.00978,w:.0236,x:.0015,y:.01974,z:74e-5};FM.caesarCypher=function(a,b){for(var c="",d=0,e=a.length;e>d;d++)c+=a[d]>="a"&&a[d]<="z"?g[(g.indexOf(a[d])+b)%26]:a[d]>="A"&&a[d]<="Z"?h[(h.indexOf(a[d])+b)%26]:a[d];return c},FM.vigenereCypher=function(a,b){for(var c="",d=0,e=0,f=b.toLowerCase(),i=0,j=a.length,k=f.length;j>i;i++)d=g.indexOf(f[e%k]),a[i]>="a"&&a[i]<="z"?(c+=g[(g.indexOf(a[i])+d)%26],e++):a[i]>="A"&&a[i]<="Z"?(c+=h[(h.indexOf(a[i])+d)%26],e++):c+=a[i];return c},FM.letterFreqency=function(a){return i[a.toLowerCase()]},FM.cipherLetterFreq=function(a){for(var b=a.toLowerCase(),c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=0,e=b.length;e>d;++d)b[d]>="a"&&b[d]<="z"&&c[g.indexOf(b[d])]++;return c},FM.bisect=function(a,b,c,d){null==b&&(b=3);var e=Math.pow(10,-b),f=Math.pow(10,b);c||(c=0);var g=a(c),h=Math.sign(g);if(0===h)return c;if(null==d){d=.5;do d*=2,hf=a(d),hs=Math.sign(hf);while(hs===h);if(0===hs)return d}for(var i=0;Math.abs(g)>e&&200>i;){var j=(c+d)/2,k=a(j),l=Math.sign(k);if(0===l)return j;l===h?(c=j,g=k):(d=j,hf=k),++i}return Math.round(c*f)*e}}();var M=M||{};M.browser={width:window.innerWidth,height:window.innerHeight,isMobile:"undefined"!=typeof orientation,isRetina:(window.devicePixelRatio||1)>1,isTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,imgExt:(window.devicePixelRatio||1)>1.25?"@2x":"",speechRecognition:"webkitSpeechRecognition"in window},M.redraw=function(){document.body.offsetHeight},M.now=Date.now||function(){return(new Date).getTime()},M.onload=function(a){window.onload=a},M.toCamelCase=function(a){return a.toLowerCase().replace(/^-/,"").replace(/-(.)/g,function(a,b){return b.toUpperCase()})},M.is3DTransform=function(){var a=document.createElement("div").style;return"webkitPerspective"in a||"MozPerspective"in a||"OPerspective"in a||"MsPerspective"in a||"perspective"in a}(),M.animationFrame=function(){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)};return function(b){a(b)}}(),M.cssTimeToNumber=function(a){var b=/^([\-\+]?[0-9]+(\.[0-9]+)?)(m?s)$/,c=b.exec(a.trim());return null===c?null:+c[1]*("s"===c[3]?1e3:1)},M.addCSSRule=function(a,b){var c=document.styleSheets[document.styleSheets.length-1],d=c.rules.length-1;c.insertRule?c.insertRule(a+"{"+b+"}",d):c.addRule(a,b,d)},function(){var a={},b=document.body.style,c={webkit:"webkit",moz:"Moz",ms:"ms"},d=function(a){var d=M.toCamelCase(a);if(null!=b[d])return a;d=d.toTitleCase();for(var e in c)if(null!=b[c[e]+d])return"-"+e+"-"+a;return a};M.prefix=function(b){if(a[b])return a[b];var c=d(b);return a[b]=c,c}}(),function(){var a=!!window.history,b=0,c=(window.location.origin+window.location.port,"localhost"===window.location.host?"/~legner/MathigonBeta/src":""),d=window.location.pathname.replace(c,""),e=window.location.hash.replace(/^#/,""),f=M.Class.extend({back:function(){a&&window.history.back()},forward:function(){a&&window.history.forward()},go:function(b){a&&window.history.go(b)},push:function(d,e){++b,e||(e={url:d}),a&&window.history.pushState({id:b,state:e},"",c+d)},replace:function(b,d){d||(d={url:b}),a&&window.history.replaceState(d,"",c+b)}});M.History=new f,Object.defineProperty(M.History,"hash",{enumerable:!0,configurable:!0,get:function(){return e},set:function(f){++b,e=f,a?window.history.pushState({id:b,state:{}},"",c+d+"#"+e):window.location.hash="#"+e}});var g="state"in window.history,h=location.href;window.addEventListener("popstate",function(a){var f=g||location.href===h;if(g=!0,f&&(d=window.location.pathname.replace(c,""),e=window.location.hash.replace(/^#/,""),a.state)){var i=a.state.id;M.History.trigger("change",a.state.state),b>i&&M.History.trigger("back",a.state.state),i>b&&M.History.trigger("forward",a.state.state),b=i}})}(),M.Cookie={get:function(a){return Cookie.has(a)?M.Cookie.list()[a]:null},has:function(a){return new RegExp("(?:;\\s*|^)"+encodeURIComponent(a)+"=").test(document.cookie)},list:function(){for(var a,b=document.cookie.split(";"),c={},d=0,e=b.length;e>d;++d)a=b[d].split("="),a[0]=a[0].replace(/^\s+|\s+$/,""),c[decodeURIComponent(a[0])]=decodeURIComponent(a[1]);return c},remove:function(a,b){var c={};for(var d in b||{})c[d]=b[d];return c.expires=new Date(0),c.maxAge=-1,Cookie.set(a,null,c)},set:function(a,b,c){c=c||{};var d=[encodeURIComponent(a)+"="+encodeURIComponent(b)];c.path&&d.push("path="+c.path),c.domain&&d.push("domain="+c.domain),c.maxAge&&d.push("max-age="+parseFloat(maxAge)),c.expires&&d.push("expires="+(isDate(c.expires)?c.expires.toUTCString():c.expires)),c.secure&&d.push("secure"),document.cookie=d.join(";")}},M.storage={},M.storage.set=function(a,b){for(var c=(a||"").split("."),d=JSON.parse(window.localStorage.getItem("M")||"{}"),e=d,f=0;f<c.length-1;++f)null==e[c[f]]&&(e[c[f]]={}),e=e[c[f]];e[c.last()]=b,window.localStorage.setItem("M",JSON.stringify(d))},M.storage.get=function(a){for(var b=(a||"").split("."),c=JSON.parse(window.localStorage.getItem("M")||"{}"),d=c,e=0;e<b.length-1;++e){if(null==d[b[e]])return null;d=d[b[e]]}return a?d[b.last()]:d},M.storage.clear=function(a){a?M.storage.set(a,null):window.localStorage.setItem("M","")},M.toQueryString=function(a){var b=[];return M.each(a,function(a,c){return c=encodeURIComponent(c),null==a?void b.push(c):(a=M.isArray(a)?a.join(","):""+a,a=a.replace(/(\r)?\n/g,"\r\n"),a=encodeURIComponent(a),a=a.replace(/%20/g,"+"),void b.push(c+"="+a))}),b.join("&")},M.fromQueryString=function(a){a=a.replace(/^[?,&]/,"");var b=decodeURIComponent(a).split("&"),c={};return b.each(function(a){var b=a.split("=");c[b[0]]=b[1]}),c},M.ajax=function(a,b){b||(b={});var c=new XMLHttpRequest,d=function(){var a=c.status;if(!a&&c.responseText||a>=200&&300>a||304===a){if(!b.success)return;if("html"===b.dataType){var d=document.implementation.createHTMLDocument("");d.open(),d.write(c.responseText),d.close(),b.success(d)}else b.success("json"===b.dataType?JSON.parse(c.responseText):c.responseText)}else b.error&&b.error(c)};c.onload?c.onload=c.onerror=d:c.onreadystatechange=function(){4===c.readyState&&d()},b.url||(b.url=window.location.toString()),("GET"===b.method||"HEAD"===b.method)&&(a+=a.indexOf("?")>=0?"&":"?",b.data&&(a+=M.toQueryString(b.data)+"&"),b.cache===!1&&(a+="_nocache="+Date.now())),null==b.async&&(b.async="true"),c.open(b.method?b.method.toUpperCase():"GET",a,b.async,b.user,b.password),b.headers&&c.setRequestHeader&&M.each(b.headers,function(a,b){c.setRequestHeader(a,b)}),null==b.crossDomain&&(b.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(b.url)&&RegExp.$2!==window.location.host),b.crossDomain&&c.setRequestHeader("X-Requested-With","XMLHttpRequest");var e=null;if(null==b.processData&&(b.processData=!0),null==b.contentType&&(b.contentType="application/x-www-form-urlencoded"),b.data&&("POST"===b.method||"PUT"===b.method)){var f=[ArrayBuffer,Blob,Document,FormData];if(!b.processData||f.indexOf(b.data.constructor)>=0)e=b.data;else{var g="---------------------------"+Date.now().toString(16);"multipart/form-data"===b.contentType?c.setRequestHeader("Content-Type","multipart/form-data; boundary="+g):c.setRequestHeader("Content-Type",b.contentType),e="";var h=M.toQueryString(b.data);if("multipart/form-data"===b.contentType){g="---------------------------"+Date.now().toString(16),h=h.split("&");for(var i=[],j=0;j<h.length;j++)i.push('Content-Disposition: form-data; name="'+h[j].split("=")[0]+'"\r\n\r\n'+h[j].split("=")[1]+"\r\n");e="--"+g+"\r\n"+i.join("--"+g+"\r\n")+"--"+g+"--\r\n"}else e="application/x-www-form-urlencoded"===b.contentType?h:h.replace(/&/g,"\r\n")}}c.send(e)},M.get=function(a,b,c){return M.ajax(a,{method:"GET",dataType:"html",data:"function"==typeof b?null:b,success:"function"==typeof b?b:c})},M.post=function(a,b,c){return M.ajax(a,{method:"POST",dataType:"html",data:"function"==typeof b?null:b,success:"function"==typeof b?b:c})},M.getJSON=function(a,b,c){return M.ajax(a,{method:"GET",dataType:"json",data:"function"==typeof b?null:b,success:"function"==typeof b?b:c})},M.getScript=function(a,b,c){var d=document.createElement("script");d.type="text/javascript",c&&(d.onerror=c),b&&(d.onload=b),document.head.appendChild(d),d.src=a},M.$=function(a){this.data={},this.$el=a},M.$.prototype.addClass=function(a){for(var b=a.split(" "),c=0;c<b.length;++c)this.$el.classList.add(b[c])},M.$.prototype.removeClass=function(a){for(var b=a.split(" "),c=0;c<b.length;++c)this.$el.classList.remove(b[c])},M.$.prototype.hasClass=function(a){return(" "+this.$el.className+" ").indexOf(" "+a+" ")>=0},M.$.prototype.toggleClass=function(a){for(var b=a.split(" "),c=0;c<b.length;++c)this.$el.classList.toggle(b[c])},M.$.prototype.setClass=function(a,b){b?this.addClass(a):this.removeClass(a)},M.$.prototype.attr=function(a,b){return null==b?this.$el.getAttribute(a):void(""===b?this.$el.removeAttribute(a):this.$el.setAttribute(a,b))},M.$.prototype.data=function(a,b){if(null==b){var c=this.$el.getAttribute("data-"+a);return c?c:this.data?this.data[a]:void 0}this.data[a]=b},M.$.prototype.value=function(a){return null==a?this.$el.value:void(this.$el.value=a)},M.$.prototype.html=function(a){return null==a?this.$el.innerHTML:void(this.$el.innerHTML=a)},M.$.prototype.text=function(a){return null==a?this.$el.textContent.trim():void(this.$el.textContent=a)},M.$.prototype.width=function(a){return this.$el===window?window.innerWidth:"padding"===a?this.$el.clientWidth:"scroll"===a?this.$el.scrollWidth:"border"===a?this.$el.offsetWidth:"margin"===a?this.$el.offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this.$el.clientWidth-parseFloat(this.css("padding-left"))-parseFloat(this.css("padding-right"))},M.$.prototype.height=function(a){return this.$el===window?window.innerHeight:"padding"===a?this.$el.clientHeight:"scroll"===a?this.$el.scrollHeight:"border"===a?this.$el.offsetHeight:"margin"===a?this.$el.offsetHeight+parseFloat(this.css("margin-top"))+parseFloat(this.css("margin-bottom")):this.$el.clientHeight-parseFloat(this.css("padding-bottom"))-parseFloat(this.css("padding-top"))},M.$.prototype.offset=function(a){if("parent"===a&&(a=this.parent()),"body"===a&&(a=M.$body),a&&a.$el===this.$el.offsetParent){var b=this.$el.offsetTop+a.$el.clientTop,c=this.$el.offsetLeft+a.$el.clientLeft,d=b+this.$el.offsetHeight,e=c+this.$el.offsetWidth;return{top:b,left:c,bottom:d,right:e}}if(a){var f=a.$el.getBoundingClientRect(),g=this.$el.getBoundingClientRect();return{top:g.top-f.top,left:g.left-f.left,bottom:g.bottom-f.top,right:g.right-f.left}}var g=this.$el.getBoundingClientRect();return{top:g.top,left:g.left,bottom:g.bottom,right:g.right}},M.$.prototype.css=function(a,b){if(1===arguments.length){if("string"==typeof a)return window.getComputedStyle(this.$el,null).getPropertyValue(a);for(var c in a)M.has(a,c)&&(this.$el.style[c]=a[c])}else 2===arguments.length&&"string"==typeof a&&(this.$el.style[M.toCamelCase(a)]=b)},M.$.prototype.transition=function(a,b,c){"string"!=typeof b&&(b+="ms"),this.$el.style[M.prefix("transition")]=a+" "+b+(c?" "+c:"")},M.$.prototype.transform=function(a){this.$el.style[M.prefix("transform")]=a},M.$.prototype.transformX=function(a){a=Math.round(a),this.$el.style[M.prefix("transform")]=M.is3DTransform?"translate3d("+a+"px,0,0)":"translate("+a+"px,0)"},M.$.prototype.transformY=function(a){a=Math.round(a),this.$el.style[M.prefix("transform")]=M.is3DTransform?"translate3d(0px,"+a+"px,0px)":"translate(0px,"+a+"px)"},M.$.prototype.hide=function(){this.css("display","none"),this.css("visibility","hidden")},M.$.prototype.show=function(){this.css("display","block"),this.css("visibility","visible")},M.$.prototype.is=function(a){for(var b=document.querySelectorAll(a),c=0,d=b.length;d>c;++c)if(b[c]===this.$el)return!0;return!1},M.$.prototype.index=function(){for(var a=0,b=this.$el;null!==(b=b.previousSibling);)a++;return a},M.$.prototype.append=function(a){var b=this;if("string"==typeof a){var c=$$N(a);c.each(function(a){b.$el.appendChild(a.$el)})}else this.$el.appendChild(a.$el)},M.$.prototype.prepend=function(a){if("string"==typeof a)for(var b=$$N(a),c=b.length-1;c>=0;c--)this.$el.insertBefore(b[c],this.$el.childNodes[0]);else this.$el.insertBefore(a.$el,this.$el.childNodes[0])},M.$.prototype.insertBefore=function(a){var b=this.parent(),c=this;if("string"==typeof a)for(var d=$$N(a),e=d.length-1;e>=0;e--)b.$el.insertBefore(d[e].$el,c.$el);else b.$el.insertBefore(a.$el,c.$el)},M.$.prototype.insertAfter=function(a){var b=this,c=b.$el.parentNode;if("string"==typeof a){var d=$$N(a);d.each(function(){})}else{var e=b.$el.nextSibling;e?c.insertBefore(a.$el,e):c.appendChild(a.$el)}},M.$.prototype.wrap=function(a){"string"==typeof a&&(a=$(document.createElement(a))),this.insertBefore(a),this.remove(),a.append(this)},M.$.prototype.moveTo=function(a,b){this.remove(),b?a.prepend(this):a.append(this)},M.$.prototype.next=function(){var a=this.$el.nextElementSibling;return a?$(a):!1},M.$.prototype.prev=function(){var a=this.$el.previousElementSibling;return a?$(a):!1},M.$.prototype.find=function(a){return $$(a,this)},M.$.prototype.parent=function(){var a=this.$el.parentNode;return a?$(a):!1},M.$.prototype.parents=function(a){for(var b=[],c=this.parent();c;)(!a||c.is(a))&&b.push(c),c=c.parent();return b},M.$.prototype.children=function(a){var b=this.$el.children;if(!b){b=[];var c=this.$el.childNodes;M.each(c,function(a){(!a.data||a.data.trim())&&b.push(a)})}if("number"==typeof a)return $(b[a]);for(var d=[],e=0,f=b.length;f>e;++e)(!a||$(b[e]).is(a))&&d.push($(b[e]));return d},M.$.prototype.remove=function(){this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},M.$.prototype.delete=function(){this.remove(),this.$el=null},M.$.prototype.clear=function(){var a=this;this.children().each(function(b){a.$el.removeChild(b.$el)})},M.$.prototype.replace=function(a){this.insertAfter(a),this.remove()},M.$.prototype.getTransitions=function(){for(var a=window.getComputedStyle(this.$el),b=a.getPropertyValue("transition-delay").split(","),c=a.getPropertyValue("transition-duration").split(","),d=a.getPropertyValue("transition-property").split(","),e=a.getPropertyValue("transition-timing-function").match(/[^\(\),]+(\([^\(\)]*\))?[^\(\),]*/g),f=[],g=0;g<d.length;++g)f.push({css:d[g].trim(),delay:M.cssTimeToNumber(b[g]),duration:M.cssTimeToNumber(c[g]),timing:e[g]});return f},M.$.prototype.setTransitions=function(a){var b=[];M.each(a,function(a){b.push([a.css,(a.duration||1e3)+"ms",a.timing||"linear",(a.delay||0)+"ms"].join(" "))}),this.css("transition",b.join(", "))},M.$.prototype.animate=function(a,b){var c=this;M.isArray(a)||(a=[a]);
var d=window.getComputedStyle(this.$el);M.each(a,function(a){"height"===a.css&&this.css("height",parseFloat(d.getPropertyValue("height"))),"width"===a.css&&this.css("width",parseFloat(d.getPropertyValue("width"))),null!=a.from&&c.css(a.css,a.from)});var e=d.getPropertyValue(M.prefix("transition"));this.setTransitions(M.merge(this.getTransitions(),a)),M.redraw(),M.each(a,function(a){c.css(a.css,a.to)}),this.transitionEnd(function(){c.css(M.prefix("transition"),e),M.redraw(),b&&b()})},M.animate=function(a,b){function c(){b>=e&&M.animationFrame(c),e=+new Date-d,a(e/b)}var d=+new Date,e=0;c()},M.$.prototype.getStrokeLength=function(){if(this.$el.getTotalLength)return this.$el.getTotalLength();var a=this.$el.getBoundingClientRect();return FM.vector.length([a.height,a.width])},M.$.prototype.enter=function(a,b,c){if(this.css("visibility","visible"),b)if(a||(a="fade"),"fade"===a)this.animate({css:"opacity",from:0,to:1,duration:b});else if("pop"===a)this.css("opacity","1"),this.animate({css:M.prefix("transform"),from:"scale(0)",to:"scale(1)",delay:c,duration:b,timing:"cubic-bezier(0.175, 0.885, 0.32, 1.275)"});else if("draw"===a){var d=this.getStrokeLength();this.css("stroke-dasharray",d+" "+d),this.animate({css:"stroke-dashoffset",from:d,to:0,delay:c,duration:b})}},M.$.prototype.exit=function(a,b,c){var d=this;if(!b)return void this.css("visibility","hidden");if(a||(a="fade"),"fade"===a)this.animate({css:"opacity",from:1,to:0,duration:b},function(){d.css("visibility","hidden")});else if("draw"===a){var e=this.getStrokeLength();this.css("stroke-dasharray",e+" "+e),this.animate({css:"stroke-dashoffset",from:0,to:e,delay:c,duration:b})}},M.$.prototype.slideUp=function(a){var b=this;this.$el.sliding="up",this.$el.style.height=this.height()+"px",M.redraw(),this.$el.style.height="0px",this.transitionEnd(function(){"up"===b.$el.sliding&&a&&a()})},M.$.prototype.slideDown=function(a){var b=this;this.$el.sliding="down",this.$el.style.height=this.children(0).height("margin")+"px",this.transitionEnd(function(){"down"===b.$el.sliding&&(b.$el.style.height="auto",a&&a())})},M.$.prototype.fadeIn=function(){var a=this;a.$el.style.display="block",M.redraw(),this.$el.style.opacity="1"},M.$.prototype.fadeOut=function(){var a=this;this.$el.style.opacity="0",this.transitionEnd(function(){a.$el.style.display="none"})},function(){var a=["pulse","pop","jumpY","jumpX","flash"];a.each(function(a){M.$.prototype[a]=function(){var b=this;b.animationEnd(function(){b.removeClass("effects-"+a)}),b.addClass("effects-"+a)}})}(),M.events={},M.events.isSupported=function(a){a="on"+a;var b=$N("div"),c=a in b.$el;return c||(b.attr(a,"return;"),c="function"==typeof b.$el[a]),b.delete(),c},M.$.prototype.on=function(a,b){a=a.split(" ");for(var c=0;c<a.length;++c)this.$el.addEventListener(a[c],b,!1)},M.$.prototype.off=function(a,b){a=a.split(" ");for(var c=0;c<a.length;++c)this.$el.removeEventListener(a[c],b,!1)},M.$.prototype.one=function(a,b){function c(){d.off(a,c),b(arguments)}var d=this;this.on(a,c)},M.$.prototype.trigger=function(a,b){var c;try{c=new CustomEvent(a,{detail:b,bubbles:!0,cancelable:!0})}catch(d){c=document.createEvent("Event"),c.initEvent(a,!0,!0),c.detail=b}this.$el.dispatchEvent(c)},M.events.pointerOffset=function(a,b){if(a.offsetX)return[a.offsetX,a.offsetY];b=b?b.$el:a.target;var c=b.getBoundingClientRect(),d=a.touches?a.touches[0].clientX:a.clientX,e=a.touches?a.touches[0].clientY:a.clientY;return[d-c.left,e-c.top]},M.events.pointerPosition=function(a){return{x:a.touches?a.touches[0].clientX:a.clientX,y:a.touches?a.touches[0].clientY:a.clientY}},M.events.getWheelDelta=function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/120),a.detail&&(b=-a.detail/3),b},M.events.stop=function(a){a.preventDefault(),a.stopPropagation()},M.$.prototype.pointerStart=function(a){this.on("mousedown touchstart",a)},M.$.prototype.pointerMove=function(a){this.on("mousemove touchmove",a)},M.$.prototype.pointerEnd=function(a){this.on("mouseup touchend mousecancel touchcancel",a)},function(){var a=function(a,b){var c=M.events.pointerPosition(b);return a.$el===document.elementFromPoint(c.x,c.y)};M.$.prototype.pointerEnter=function(b,c){var d=this,e=null;c.pointerEnd(function(){e=null}),c.pointerMove(function(c){var f=e;e=a(d,c),null!=f&&e&&!f&&b(c)})},M.$.prototype.pointerLeave=function(b,c){var d=this,e=null;c.pointerMove(function(c){var f=e;e=a(d,c),!e&&f&&b(c)})},M.$.prototype.pointerMoveOver=function(b,c){var d=this;c.on("touchmove mousemove",function(c){a(d,c)&&b(c)})}}(),M.$.prototype.transitionEnd=function(a){var b=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"];this.one(b.join(" "),a)},M.$.prototype.animationEnd=function(a){function b(e){a.call(d,e),d.off(c,b)}var c=["webkitAnimationEnd","OAnimationEnd","MSAnimationEnd","animationend"].join(" "),d=this;this.on(c,b)},M.$.prototype.change=function(a){this.on("propertychange keyup input paste",a)},M.$.prototype.click=function(a){var b,c,d=!1,e=this,f=!1;this.on("mousedown",function(a){f||(d=!0,b=a.clientX,c=a.clientY)}),this.on("mouseup",function(g){if(f)return void(f=!1);if(d){var h=g.clientX,i=g.clientY;Math.abs(h-b)<2&&Math.abs(i-c)<2&&a.call(e,g)}d=!1}),this.on("touchstart",function(a){f=!0,1===a.touches.length&&(d=!0,b=a.changedTouches[0].clientX,c=a.changedTouches[0].clientY)}),this.on("touchend",function(f){if(d&&1===f.changedTouches.length){var g=f.changedTouches[0].clientX,h=f.changedTouches[0].clientY;Math.abs(g-b)<5&&Math.abs(h-c)<5&&a.call(e,f)}d=!1}),this.on("touchcancel",function(){d=!1})},M.$.prototype.scroll=function(a){function b(){i=f.$el.scrollTop,a.start&&a.start(),h=!0}function c(){h||b(),a.move&&a.move(),g&&window.clearTimeout(g),g=window.setTimeout(d,100)}function d(){a.end&&a.end(),h=!1}function e(){window.removeEventListener("touchmove",c),window.removeEventListener("touchend",e)}var f=this,g=null,h=!1,i=0,j=this.$el;this.on("wheel mousewheel DOMMouseScroll",c),this.on("touchstart",function(){var a=j.scrollTop;0>=a&&(j.scrollTop=1),a+j.offsetHeight>=j.scrollHeight&&(j.scrollTop=j.scrollHeight-j.offsetHeight-1),b(),window.addEventListener("touchmove",c),window.addEventListener("touchend",e)})},function(){var a="blur focus keyup keydown keypress submit".split(" ");a.each(function(a){M.$.prototype[a]=function(b){null==b?this.trigger(a):this.on(a,b)}})}(),M.activeInput=function(){return document.activeElement===document.body?void 0:document.activeElement},M.keyboardEvent=function(a,b){a instanceof Array||(a=[a]),document.addEventListener("keydown",function(c){for(var d=c.keyCode||c.which,e=0;e<a.length;++e)d!==a[e]||M.activeInput()||(c.preventDefault(),b(c))})},M.keyboardMultiEvent=function(a,b,c,d){var e=!1;document.addEventListener("keydown",function(f){var g=f.keyCode||f.which;g===b?e=!0:e&&g===a&&!M.activeInput()?(f.preventDefault(),d(f)):g!==a||M.activeInput()||(f.preventDefault(),c(f))}),document.addEventListener("keyup",function(a){var c=a.keyCode||a.which;c===b&&(e=!1)})},function(){function a(a,b,c){switch(a){case"quad":return b*b;case"cubic":return b*b*b;case"quart":return b*b*b*b;case"quint":return b*b*b*b*b;case"circ":return 1-Math.sqrt(1-b*b);case"sine":return 1-Math.cos(b*Math.PI/2);case"exp":return 0>=b?0:Math.pow(2,10*(b-1));case"back":return null==c&&(c=1.70158),b*b*((c+1)*b-c);case"elastic":return null==c&&(c=.3),-Math.pow(2,10*(b-1))*Math.sin((2*(b-1)/c-.5)*Math.PI);case"bounce":return 1/11>b?1/64-7.5625*(.5/11-b)*(.5/11-b):3/11>b?1/16-7.5625*(2/11-b)*(2/11-b):7/11>b?.25-7.5625*(5/11-b)*(5/11-b):1-7.5625*(1-b)*(1-b);default:return b}}M.easing=function(b,c,d){return 0==c?0:1==c?1:(b=b.split("-"),"in"==b[1]?a(b[0],c,d):"out"==b[1]?1-a(b[0],1-c,d):.5>=c?a(b[0],2*c,d)/2:1-a(b[0],2*(1-c),d)/2)}}(),M.$.prototype.scrollTo=function(a,b,c,d){function e(){i=+new Date-l;var a=j+k*M.easing(c,i/b);g.$el.scrollTop=a,d&&d(a)}function f(){!h&&b>i&&M.animationFrame(f),e()}var g=this;0>a&&(a=0),c||(c="cubic");var h=!1;this.scroll({scroll:function(){h=!0}}),this.on("touchstart",function(){h=!0});var i=0,j=this.$el.scrollTop,k=a-j,l=+new Date;f()},M.$body=$(document.body),M.$html=$(document.getElementsByTagName("html")[0]),M.$window=$(window),M.$html.addClass(M.browser.isTouch?"touch":"no-touch"),M.$html.addClass(M.browser.isMobile?"mobile":"no-mobile"),function(){var a=[[],[],[]],b=function(){var b=[window.innerWidth,window.innerHeight];a.each(function(a){a.each(function(a){a(b)})})};M.resize=function(c,d){c?a[d||0].push(c):b()},M.offResize=function(b){var c=a.indexOf(b);c>=0&&a.splice(c,1)};var c=null;M.$window.on("resize",function(){clearTimeout(c),c=setTimeout(function(){b()},100)})}(),M.Gallery=function(a,b){b||(b={});var c=$N("div",{"class":"gallery-wrapper"}),d=$N("div",{"class":"gallery-box"});a.wrap(c),c.wrap(d);var e,f,g,h=a.children(),i=h.length,j=a.attr("data-slide-width")||null,k=0,l=0,m=$N("div",{"class":"gallery-next"},d),n=$N("div",{"class":"gallery-back"},d);$N("div",{"class":"icon"},m),$N("div",{"class":"icon"},n);var o=$N("div",{"class":"gallery-dots"},d),p=[];h.each(function(a){a.addClass("gallery-slide"),p.push($N("div",{"class":"gallery-dot"},o))});var q,r,s,t,u=function(b){l=b,a.transformX(b)},v=function(a){k=a,p.each(function(b,c){b.setClass("on",c>=a&&a+f>c)}),b.callback&&b.callback(a),m.setClass("disabled",a===i-f),n.setClass("disabled",0===a)},w=function(){e=c.width("border"),f=j?Math.ceil(e/j):1,g=e/f,h.each(function(a){a.css("width",g+"px")}),a.css("width",i*g+"px"),u(-k*g),v(k)},y="quad",z=500,A=!1,B=function(){q=+new Date-t,u(r+s*M.easing(y,q/z))},C=function(){!A&&z>q&&M.animationFrame(C),B()},D=function(a){A=!1,q=0,r=l,s=-a*g-l,t=+new Date,v(a),C()},E=function(){y="quad",i-f>k&&(m.pulse(),D(k+1))},F=function(){y="quad",k>0&&(n.pulse(),D(k-1))};m.click(E),n.click(F);var G=null,H=null,I=null,J=null,K=function(){M.$body.on("mousemove touchmove",L),M.$body.on("mouseup mouseleave touchend touchcancel",N),A=!0,G=l,H=event.touches?event.touches[0].clientX:event.clientX,J=I=H},L=function(a){a.preventDefault();var b=event.touches?event.touches[0].clientX:event.clientX;I=J,J=b;var c=G-H+b,d=-(i-f)*g;u(c>0?c/4:d>c?d+(c-d)/4:c)},N=function(){M.$body.off("mousemove touchmove",L),M.$body.off("mouseup mouseleave touchend touchcancel",N),x=event.touches?event.touches[0].clientX:event.clientX;var a=J-I,b=a>12?1:-12>a?-1:0;y="quad-out",D(Math.round(-l/g-b).bound(0,i-f))};return c.on("mousedown touchstart",K),w(),M.resize(w),{next:E,back:F}},M.Draggable=M.Class.extend({init:function(a,b,c,d){var e,f,g=this,h="y"!==c,i="x"!==c,j=[0,0],k=[null,null],l=function(a){return[event.touches?a.touches[0].clientX:a.clientX,event.touches?a.touches[0].clientY:a.clientY]},m=function(b,c){h&&a.css("left",Math.round(b)+"px"),i&&a.css("top",Math.round(c)+"px"),g.trigger("change",{x:b,y:c,width:e,height:f})};this.set=function(a,b){m(a,b),j=[a,b]},this.get=function(){return{x:j[0],y:j[1],width:e,height:f}};var n=function(a){M.$body.on("mousemove touchmove",o),M.$body.on("mouseup mouseleave touchend touchcancel",p),k=l(a),g.trigger("start")},o=function(a){a.preventDefault();var b=l(a),c=(j[0]+b[0]-k[0]).bound(0,e),d=(j[1]+b[1]-k[1]).bound(0,f);m(c,d)},p=function(a){M.$body.off("mousemove touchmove",o),M.$body.off("mouseup mouseleave touchend touchcancel",p);var b=l(a);if(b[0]==k[0]&&b[1]==k[1])g.trigger("click");else{var c=(j[0]+b[0]-k[0]).bound(0,e),d=(j[1]+b[1]-k[1]).bound(0,f);j=[c,d],g.trigger("end")}};a.on("mousedown touchstart",n);var q=function(){var a=e,c=f;e=b.width("border")-2*d,f=b.height("border")-2*d,g.set(e/(a||e)*j[0],f/(c||f)*j[1])};q(),M.resize(q)}}),M.Slider=M.Class.extend({init:function(a,b){var c=this;a.addClass("slider-track");var d=$N("div",{"class":"slider-knob"},a);$N("div",{"class":"icon"},d);var e,f=new M.Draggable(d,a,"x",4);f.on("start",function(){g=!0}),f.on("change",function(a){var d=Math.floor(a.x/a.width*b);d!==e&&c.trigger("move",d),e=d});var g=!1;f.on("click",function(){c.play()});var h=function(){var a=f.get();!g&&a.x<a.width&&M.animationFrame(h),f.set(a.x+2)};this.play=function(){g=!1,d.pulse(),h()},f.set(0,0)}}),M.ImageSequence=M.Class.extend({init:function(a){var b=$N("div");a.wrap(b);for(var c=a.attr("data-src"),d=Number(a.attr("data-pages"))-1,e=$N("div",{},b),f=new M.Slider(e,d),g=[],h=1;d>h;++h)g[h]=new Image,g[h].src=c.replace("#",h);f.on("move",function(b){a.attr("src",c.replace("#",b))}),f.trigger("move",0)}}),M.svg={},M.svg.el=function(a,b,c){var d=this,e="http://www.w3.org/2000/svg";this.$el=document.createElementNS(e,a),this.data={},M.each(b,function(a,b){d.$el.setAttribute(b,a)}),c&&c.append(this)},M.inherit(M.svg.el,M.$),M.svg.el.prototype.setPoints=function(a){this.attr("d",a.length?"M"+a.each(function(a){return a.join(",")}).join("L"):""),this.points=a},M.svg.el.prototype.addPoint=function(a){this.attr("d",this.attr("d")+" L "+a.join(",")),this.points.push(a)},M.svg.el.prototype.getPoints=function(){var a=this.$el.attr("d").replace("M","").split("L");return a.each(function(a){return a.split(",").toNumbers()})},M.colour={red:"#D90000",orange:"#F15A24",yellow:"#edd200",lime:"#b2d300",green:"#00B200",cyan:"#29ABE2",blue:"#006DD9",violet:"#662D91",purple:"#9d0069",pink:"#ED1E79"},M.colour.parse=function(a){return"#"===a[0]?[parseInt(a.substr(1,2),16),parseInt(a.substr(3,2),16),parseInt(a.substr(5,2),16)]:a.indexOf("rgb")>=0?a.replace("rgb(","").replace("rgba(","").replace(")","").split(",").each(function(a){return+a}):null},function(){var a=function(a){return 1===a.length?"0"+a:a},b=function(){var b=M.colour.parse(colour);return"#"+b.each(function(b){return a(Math.round(b).toString(16))}).join("")},c=function(a){var b=a[3]||0===a[3];return"rgb"+(b?"a(":"(")+a.slice(0,3).each(function(a){return Math.round(a)}).join(",")+(b?","+a[3]:"")+")"};M.colour.toRgb=function(a){return c(M.colour.parse(a))},M.colour.toHex=function(a){return b(M.colour.parse(a))},M.colour.interpolate=function(a,b,d){d=d.bound(0,1),a=M.colour.parse(a),b=M.colour.parse(b);var e=null!=a[3]||null!=b[3];return null==a[3]&&(a[3]=1),null==b[3]&&(b[3]=1),c([d*a[0]+(1-d)*b[0],d*a[1]+(1-d)*b[1],d*a[2]+(1-d)*b[2],e?d*a[3]+(1-d)*b[3]:null])}}(),M.colour.getColourAt=function(a,b){b=b.bound(0,.999);var c=Math.floor(b*(a.length-1)),d=b*(a.length-1)-c;return M.colour.interpolate(a[c+1],a[c],d)},function(){var a=["#D92120","#E6642C","#E68E34","#D9AD3C","#B5BD4C","#7FB972","#63AD99","#55A1B1","#488BC2","#4065B1","#413B93","#781C81"];M.colour.rainbow=function(b){var c=(.4+.15*b).bound(0,1);return FM.tabulate(function(d){return M.colour.getColourAt(a,c*d/(b-1))},b)};var b=["#3D52A1","#3A89C9","#77B7E5","#B4DDF7","#E6F5FE","#FFFAD2","#FFE3AA","#F9BD7E","#ED875E","#D24D3E","#AE1C3E"];M.colour.temperature=function(a){var c=(.1*a).bound(0,1);return FM.tabulate(function(d){return M.colour.getColourAt(b,(1-c)/2+c*d/(a-1))},a)};var c=["#FFFFE5","#FFF7BC","#FEE391","#FEC44F","#FB9A29","#EC7014","#CC4C02","#993404","#662506"];M.colour.solar=function(a){return FM.tabulate(function(b){return M.colour.getColourAt(c,b/(a-1))},a)}}(),M.Audio={files:{},playing:null,load:function(a,b){return M.Audio.files[b]=new Audio(a),M.Audio.files[b].load(),M.Audio.files[b].addEventListener("timeupdate",function(){M.Audio.playing&&M.Audio.playing.update()}),M.Audio.files[b]}},M.Audio.chunk=M.Class.extend({init:function(a,b){"string"==typeof b&&(b=b.split("|").toNumbers()),this.times=b,this.currentTime=b[0],this.duration=b[1]-b[0],this.player=M.Audio.files[a]||M.Audio.load(a,Math.floor(1e4*Math.random())),this.ended=!1},play:function(){var a=this;return this.player.readyState<2?void $(this.player).one("canplay seeked",function(){a.play()}):(M.Audio.playing&&M.Audio.playing.pause(),M.Audio.playing=this,this.ended=!1,this.player.currentTime=this.currentTime,this.player.play(),void this.trigger("play",{p:(this.currentTime-this.times[0])/this.duration,t:this.currentTime}))},pause:function(){M.Audio.playing===this&&this.player.pause(),this.trigger("pause")},setTime:function(a){this.player.readyState&&(this.player.currentTime=a),this.trigger("timeupdate",{p:(a-this.times[0])/this.duration,t:a})},reset:function(){M.Audio.playing===this&&this.player.pause(),this.player.readyState&&(this.currentTime=this.times[0]),this.ended=!0,this.trigger("reset")},update:function(){return this.ended?void 0:(M.Audio.playing===this&&(this.currentTime=this.player.currentTime),this.currentTime>=this.times[1]?(this.ended=!0,this.pause(),void this.trigger("end")):void this.trigger("timeupdate",{p:(this.currentTime-this.times[0])/this.duration,t:this.currentTime}))}}),M.speechRecognition=function(){if(!M.browser.speechRecognition)return{start:function(){a.start()},stop:function(){a.stop()},addCommand:function(){},removeCommand:function(){},available:!1};var a=new window.webkitSpeechRecognition;a.continuous=!0,a.language="en-US";var b={},c=function(a){a=a.toLowerCase().trim(),b[a]&&b[a]()};a.onresult=function(a){for(var b=a.resultIndex;b<a.results.length;++b)console.debug("Voice Input: ",a.results[b][0].transcript),c(a.results[b][0].transcript)};var d=function(a,c){a instanceof Array||(a=[a]);for(var d=0;d<a.length;++d)b[a[d].toLowerCase()]=c},e=function(a){a instanceof Array||(a=[a]);for(var c=0;c<a.length;++c)b[a[c].toLowerCase()]=void 0};return{start:function(){a.start()},stop:function(){a.stop()},addCommand:d,removeCommand:e,available:!0}},M.piechart=function(a,b,c){var d;if(a>=1)d=['<svg width="',2*b,'" height="',2*b,'">','<path fill="',c,'" stroke="none" d="M',b,",0C",.5*b,",0,0,",.5*b,",0,",b,"s",.5*b,",",b,",",b,",",b,"s",b,"-",.5*b,",",b,"-",b,"S",1.5*b,",0,",b,",0","z M",44.6*b/50,",",76.1*b/50,"L",19.2*b/50,",",48.8*b/50,"l",4*b/50,"-",4.2*b/50,"l",19.8*b/50,",",11.9*b/50,"l",34.2*b/50,"-",32.6*b/50,"l",3.5*b/50,",",3.5*b/50,"L",44.6*b/50,",",76.1*b/50,'z"/>',"</svg>"].join("");else{var e=b+b*Math.sin(2*a*Math.PI),f=b-b*Math.cos(2*a*Math.PI);d=['<svg width="',2*b,'" height="',2*b,'">','<circle cx="',b,'" cy="',b,'" r="',b-.5,'" stroke="',c,'" stroke-width="1" fill="transparent"/>','<path d="M ',b," ",b," L ",b," 0 A ",b," ",b," 0 "+(a>.5?"1":"0")+" 1 "+e+" "+f+' Z" fill="',c,'"/>',"</svg>"].join("")}return d},M.draw=function(a,b){var c=this;a.addClass("m-draw-pointer"),c.options=b,c.drawing=!1,c.paths=[],c.p=null;var d=null;c.start=function(e){c.p&&FM.geo.distance(c.p,e)<20?d.addPoint(e):(b.onStart&&b.onStart(e),d=new M.svg.el("path",{"class":"m-draw-path",d:"M "+e.join(",")},b.paths||a),d.points=[e],c.paths.push(d)),c.drawing=!0,c.p=e},c.addPoint=function(a){FM.geo.manhatten(c.p,a)>4&&(d.addPoint(a),c.p=a,b.onIntersect&&c.checkForIntersects())},b.noStart||a.on("mousedown touchstart",function(b){b.preventDefault(),b.stopPropagation();var d=M.events.pointerOffset(event,a);c.start(d)}),a.on("mousemove touchmove",function(b){if(c.drawing){b.preventDefault(),b.stopPropagation();var d=M.events.pointerOffset(event,a);c.addPoint(d)}}),a.on("mouseup touchend mouseleave touchleave",function(){c.drawing=!1})},M.draw.prototype.checkForIntersects=function(){if(!(this.paths.length<=1))for(var a=this.paths.last(),b=a.points[a.points.length-2],c=a.points[a.points.length-1],d=0;d<this.paths.length-1;++d)for(var e=this.paths[d].points.length,f=1;e-2>f;++f){var g=FM.geo.intersect(b,c,this.paths[d].points[f],this.paths[d].points[f+1]);if(g)return void this.options.onIntersect(g,a,this.paths[d])}},M.draw.prototype.stop=function(){this.drawing=!1,this.p=null},M.draw.prototype.clear=function(){this.paths.each(function(a){a.remove()}),this.paths=[]};